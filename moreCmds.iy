-- \\ shawnjbragdon#0001
-- \\ send me scripting requests please.
-- \\ all of this is my work, nobody elses.

local Hint = Instance.new("Hint")
Hint.Name = "Hint"
Hint.Parent = game:GetService("CoreGui")
Hint.Text = "moreCmds.iy is launching..."

while not game:IsLoaded() do Hint.Text = "moreCmds.iy is waiting for the game to finish loading." wait(1) end

Hint:Destroy()

local ServiceDictionary = setmetatable({},{__index = function(self,index) return game:GetService(index) end})

local print = ServiceDictionary.RunService:IsStudio() and print or (function(str) return true end)
local warn = ServiceDictionary.RunService:IsStudio() and warn or (function(str) return true end)
local getrawmetatable = (getrawmetatable ~= nil and getrawmetatable) or (function() return error("free exploit reeeeeeeeee") end)
local setreadonly = (setreadonly ~= nil and setreadonly) or (make_writeable ~= nil and make_writeable) or (function() return error("free exploit reeeeeeeeee") end)
local newcclosure = (newcclosure ~= nil and newcclosure) or (function() return error("free exploit reeeeeeeeee") end)
local getnamecallmethod = (getnamecallmethod ~= nil and getnamecallmethod) or (function() return error("free exploit reeeeeeeeee") end)
local checkcaller = (checkcaller ~= nil and checkcaller) or (function() return error("free exploit reeeeeeeeee") end)
local firesignal = (firesignal ~= nil and firesignal) or (function() return error("free exploit reeeeeeeeee") end)
local notify = (notify ~= nil and notify) or (function(str) return end)
local gethiddenproperty = (gethiddenproperty ~= nil and gethiddenproperty) or (function() return nil end)
local sethiddenproperty = (sethiddenproperty ~= nil and sethiddenproperty) or (function() return nil end)
local emoteIds = loadstring(game:HttpGet("https://pastebin.com/raw/PYqzUWbd", true))()
local emoteSourceIds = loadstring(game:HttpGet("https://pastebin.com/raw/KbRbLT7E", true))()

local booleans = {
	["emotes_loop"] = false,
	["hide_characters"] = false,
}

local moreCmdsFolder = Instance.new("Folder")
moreCmdsFolder.Name = "Folder"
moreCmdsFolder.Parent = ServiceDictionary.CoreGui
moreCmdsFolder.AncestryChanged:Connect(function() moreCmdsFolder.Parent = ServiceDictionary.CoreGui end)

local LightingSave = {
	["Instances"] = {},
	["Properties"] = {
		["Ambient"] = ServiceDictionary.Lighting.Ambient,
		["Brightness"] = ServiceDictionary.Lighting.Brightness,
		["ColorShift_Bottom"] = ServiceDictionary.Lighting.ColorShift_Bottom,
		["ColorShift_Top"] = ServiceDictionary.Lighting.ColorShift_Top,
		["EnvironmentDiffuseScale"] = ServiceDictionary.Lighting.EnvironmentDiffuseScale,
		["EnvironmentSpecularScale"] = ServiceDictionary.Lighting.EnvironmentSpecularScale,
		["GlobalShadows"] = ServiceDictionary.Lighting.GlobalShadows,
		["OutdoorAmbient"] = ServiceDictionary.Lighting.OutdoorAmbient,
		["ShadowSoftness"] = ServiceDictionary.Lighting.ShadowSoftness,
		["ClockTime"] = ServiceDictionary.Lighting.ClockTime,
		["GeographicLatitude"] = ServiceDictionary.Lighting.GeographicLatitude,
		["Name"] = ServiceDictionary.Lighting.Name,
		["TimeOfDay"] = ServiceDictionary.Lighting.TimeOfDay,
		["ExposureCompensation"] = ServiceDictionary.Lighting.ExposureCompensation,
		["FogColor"] = ServiceDictionary.Lighting.FogColor,
		["FogEnd"] = ServiceDictionary.Lighting.FogEnd,
		["FogStart"] = ServiceDictionary.Lighting.FogStart,
	},
}

local function getstrictpropertyvalue(inst, property)
	local val = inst[property]

	if typeof(val) == "EnumItem" then val = val.Name end
	if typeof(val) == "number" then val = tostring(val) end
	if typeof(val) ~= "string" then val = tostring(val) end

	return val
end

local function getstrictvalue(val)
	if typeof(val) == "EnumItem" then val = val.Name end
	if typeof(val) == "number" then val = tostring(val) end
	if typeof(val) ~= "string" then val = tostring(val) end

	return val
end

local function applyproperties(source, properties)
	local allpropertieschanged = true
	for index,value in pairs(properties) do
		local success = pcall(function() source[index] = value end)
		if not success then success = pcall(sethiddenproperty, source, index, value) end
		if not success then allpropertieschanged = false end
	end
	return allpropertieschanged
end

local function swait(number, central_function)
	if number ~= nil and tonumber(number) then
		number = tonumber(number)
		for i = 1, number - 1 do
			if math.ceil(i / 2) == number / 2 then
				pcall(central_function)
			end
			ServiceDictionary.RunService.Stepped:Wait()
		end
	end
	return ServiceDictionary.RunService.Stepped:Wait()
end

local plugin = {
	["PluginName"] = string.format("%s | moreCmds.iy", ServiceDictionary.Players:GetNameFromUserIdAsync(1708043824));
	["PluginDescription"] = ("More commands for Infinite Yield, created by " .. ServiceDictionary.Players:GetNameFromUserIdAsync(1708043824));
	["Commands"] = {
		["emote"] = {
			["ListName"] = "emote [name]";
			["Description"] = "Use an emote in the ROBLOX catalog.";
			["Aliases"] = {};
			["Function"] = function(args, speaker)
				local Character = speaker.Character
				local Humanoid = Character:FindFirstChildWhichIsA("Humanoid")
				local Animator = Humanoid:FindFirstChildWhichIsA("Animator")

				local FullName = (#args > 1 and table.concat(args," ")) or args[1]

				for index,value in pairs(emoteSourceIds) do
					if string.lower(FullName) == string.sub(string.lower(tostring(index)), 1, string.len(FullName)) then
						local Animation = Instance.new("Animation")
						Animation.AnimationId = string.format("rbxassetid://%s", tostring(value))
						local AnimationTrack = Animator:LoadAnimation(Animation)
						AnimationTrack.Name = "iymc_emotetrack"
						AnimationTrack.Priority = Enum.AnimationPriority.Idle
						if booleans["emotes_loop"] == true then AnimationTrack.Looped = true end
						AnimationTrack:Play()
						AnimationTrack.Stopped:Connect(function()
							local HumanoidState = Humanoid:GetState()
							print("The animation was stopped whilst the humanoid's state was " .. tostring(HumanoidState))
							Animation:Destroy()
						end)
						Humanoid.Running:Connect(function(Speed)
							if Speed > 0.1 then
								AnimationTrack:Stop()
							end
						end)
					end
				end
			end,
		},
		["loopemote"] = {
			["ListName"] = "loopemote / make_emote_looped",
			["Description"] = "Loops your current & highest priority animation. (Does not work with non-caller animations for security reasons)",
			["Aliases"] = {"make_emote_looped", },
			["Function"] = function(args, speaker)
				local Character = speaker.Character
				local Humanoid = Character:FindFirstChildWhichIsA("Humanoid")
				local Animator = Humanoid:FindFirstChildWhichIsA("Animator")
				
				for index,value in pairs(Animator:GetPlayingAnimationTracks()) do
					if value.Name == "iymc_emotetrack" then
						value.Looped = true
						value:Play()
					end
				end
			end,
		},
		["emotesloop"] = {
			["ListName"] = "emotesloop [boolean]",
			["Description"] = "Loops your current & highest priority animation. (Does not work with non-caller animations for security reasons)",
			["Aliases"] = {"make_emote_looped", },
			["Function"] = function(args, speaker)
				if table.find({"true", "false"}, string.lower(args[1])) then
					args[1] = string.lower(args[1])
					booleans["emotes_loop"] = (args[1] == "true" and true) or (args[1] == "false" and false)
					
					local Character = speaker.Character
					local Humanoid = Character:FindFirstChildWhichIsA("Humanoid")
					local Animator = Humanoid:FindFirstChildWhichIsA("Animator")

					for index,value in pairs(Animator:GetPlayingAnimationTracks()) do
						if value.Name == "iymc_emotetrack" then
							value.Looped = true
							value:Play()
						end
					end
				end
			end,
		},
		["disablegameguis"] = {
			["ListName"] = "disablegameguis",
			["Description"] = "",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				for index,value in pairs(speaker:FindFirstChildWhichIsA("PlayerGui"):GetChildren()) do
					if value:IsA("ScreenGui") and not table.find({"chat", "freecam"}, string.lower(value.Name)) then
						value.Enabled = false
					end
				end
			end,
		},
		["futureisbright"] = {
			["ListName"] = "futureisbright",
			["Description"] = "",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				sethiddenproperty(ServiceDictionary.Lighting, "Technology", Enum.Technology.Future)
			end,
		},
		["threshold"] = {
			["ListName"] = "threshold [number]",
			["Description"] = "",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				if not tonumber(args[1]) then
					return
				end
				local BloomEffect = ServiceDictionary.Lighting:FindFirstChildWhichIsA("BloomEffect") or Instance.new("BloomEffect", ServiceDictionary.Lighting)
				BloomEffect.Threshold = tonumber(args[1])
			end,
		},
		["blockreach"] = {
			["ListName"] = "blockreach [size]",
			["Description"] = "Increases the held tool\'s size to the given size. If not set, then it will use 100.",
			["Aliases"] = {"bloreach", "reachblock", },
			["Function"] = function(args, speaker)
				local Character = speaker.Character
				local Humanoid = Character:FindFirstChildWhichIsA("Humanoid")
				local BackpackItem = Character:FindFirstChildWhichIsA("Tool")
				local Handle = BackpackItem:FindFirstChild("Handle")

				local size = tonumber(args[1]) or 100

				Humanoid:UnequipTools()
				swait(2, function()
					local SelectionBox = Instance.new("SelectionBox")
					SelectionBox.Name = "iymc_selectionbox"
					SelectionBox.Parent = moreCmdsFolder
					SelectionBox.Color3 = Color3.fromRGB(180, 180, 180)
					SelectionBox.LineThickness = 0.05
					SelectionBox.Adornee = Handle
					
					BackpackItem.Equipped:Connect(function()
						SelectionBox.Adornee = Handle
					end)
					
					BackpackItem.Unequipped:Connect(function()
						SelectionBox.Adornee = nil
					end)
					
					Handle.CanCollide = false
					Handle.Anchored = false
					Handle.Massless = true
					Handle.Size = Vector3.new(size, size, size)
				end)
				Humanoid:EquipTool(BackpackItem)
				Humanoid.PlatformStand = true
			end
		},
		["fixtool"] = {
			["ListName"] = "fixtool / toolfix",
			["Description"] = "Repairs the tools anchoring and collision settings.",
			["Aliases"] = {"toolfix", },
			["Function"] = function(args, speaker)
				local Character = speaker.Character
				local Humanoid = Character:FindFirstChildWhichIsA("Humanoid")
				local BackpackItem = Character:FindFirstChildWhichIsA("BackpackItem")
				local Handle = BackpackItem:FindFirstChild("Handle")

				Humanoid:UnequipTools()
				swait(2, function()
					Handle.CanCollide = false
					Handle.Anchored = false
					Handle.Massless = true
				end)
				Humanoid:EquipTool(BackpackItem)
			end
		},
		["starterplayer_restore"] = {
			["ListName"] = "starterplayer_restore",
			["Description"] = "Restores all StarterPlayer settings on your player & character instances.",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				speaker["CameraMaxZoomDistance"] = ServiceDictionary.StarterPlayer["CameraMaxZoomDistance"]
				speaker["CameraMinZoomDistance"] = ServiceDictionary.StarterPlayer["CameraMinZoomDistance"]
				speaker["CameraMode"] = ServiceDictionary.StarterPlayer["CameraMode"]

				local Character = speaker.Character
				local Humanoid = Character:FindFirstChildWhichIsA("Humanoid")

				Humanoid["MaxSlopeAngle"] = ServiceDictionary.StarterPlayer["CharacterMaxSlopeAngle"]
				Humanoid["WalkSpeed"] = ServiceDictionary.StarterPlayer["CharacterWalkSpeed"]
			end,
		},
		["starterplayer_fullrestore"] = {
			["ListName"] = "starterplayer_fullrestore",
			["Description"] = "Restores all StarterPlayer settings on all players (CLIENT).",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				speaker["CameraMaxZoomDistance"] = ServiceDictionary.StarterPlayer["CameraMaxZoomDistance"]
				speaker["CameraMinZoomDistance"] = ServiceDictionary.StarterPlayer["CameraMinZoomDistance"]
				speaker["CameraMode"] = ServiceDictionary.StarterPlayer["CameraMode"]

				local Character = speaker.Character
				local Humanoid = Character:FindFirstChildWhichIsA("Humanoid")

				Humanoid["MaxSlopeAngle"] = ServiceDictionary.StarterPlayer["CharacterMaxSlopeAngle"]
				Humanoid["WalkSpeed"] = ServiceDictionary.StarterPlayer["CharacterWalkSpeed"]

				for index,value in pairs(workspace:GetDescendants()) do
					if value:IsA("Model") and ServiceDictionary.Players:GetPlayerFromCharacter(value) then
						pcall(function()
							local Humanoid = value:FindFirstChildWhichIsA("Humanoid")
							Humanoid.HealthDisplayDistance = ServiceDictionary.StarterPlayer["HealthDisplayDistance"]
							Humanoid.NameDisplayDistance = ServiceDictionary.StarterPlayer["NameDisplayDistance"]
						end)
					end
				end
			end,
		},
		["namedisplaydistance"] = {
			["ListName"] = "namedisplaydistance [number]",
			["Description"] = "",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				if not tonumber(args[1]) then
					return
				end
				for index,value in pairs(ServiceDictionary.Players:GetPlayers()) do
					pcall(function()
						value.Character:FindFirstChildWhichIsA("Humanoid")["NameDisplayDistance"] = tonumber(args[1])
					end)
				end
			end
		},
		["healthdisplaydistance"] = {
			["ListName"] = "healthdisplaydistance [number]",
			["Description"] = "",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				if not tonumber(args[1]) then
					return
				end
				for index,value in pairs(ServiceDictionary.Players:GetPlayers()) do
					pcall(function()
						value.Character:FindFirstChildWhichIsA("Humanoid")["HealthDisplayDistance"] = tonumber(args[1])
					end)
				end
			end
		},
		["soundservice_ambientreverb"] = {
			["ListName"] = "soundservice_dopplerscale [number]",
			["Description"] = "SoundService.DopplerScale",
			["Aliases"] = {"reverbtype", },
			["Function"] = function(args, speaker)
				pcall(function() args[1] = tonumber(args[1]) end)
				pcall(function() args[1] = tostring(args[1]) end)
				ServiceDictionary.SoundService.AmbientReverb = args[1]
			end
		},
		["soundservice_distancefactor"] = {
			["ListName"] = "soundservice_distancefactor [number]",
			["Description"] = "SoundService.DistanceFactor",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				ServiceDictionary.SoundService.DistanceFactor = tonumber(args[1])
			end
		},
		["soundservice_dopplerscale"] = {
			["ListName"] = "soundservice_dopplerscale [number]",
			["Description"] = "SoundService.DopplerScale",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				ServiceDictionary.SoundService.DopplerScale = tonumber(args[1])
			end
		},
		["soundservice_rolloffscale"] = {
			["ListName"] = "soundservice_rolloffscale [number]",
			["Description"] = "SoundService.RolloffScale",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				ServiceDictionary.SoundService.RolloffScale = tonumber(args[1])
			end
		},
		["get_soundservice_respectfilteringenabled"] = {
			["ListName"] = "get_soundservice_respectfilteringenabled",
			["Description"] = "SoundService.RespectFilteringEnabled",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				notify("SoundService.RespectFilteringEnabled = " .. tostring(ServiceDictionary.SoundService.RespectFilteringEnabled))
			end
		},
		["goto_nearest_spawn"] = {
			["ListName"] = "goto_nearest_spawn",
			["Description"] = "Teleport to the nearest SpawnLocation.",
			["Aliases"] = {},
			["Function"] = function(args, speaker)
				local SpawnLocations = {}
				for index,value in pairs(workspace:GetDescendants()) do
					if value:IsA("SpawnLocation") then
						table.insert(SpawnLocations, value)
					end
				end
				local ShortestDistance = 1e100
				local ClosestSpawnLocation
				for index,value in pairs(SpawnLocations) do
					local Distance = (speaker.Character:FindFirstChild("HumanoidRootPart").Position - value.Position).Magnitude
					if Distance < ShortestDistance then
						ShortestDistance = Distance
						ClosestSpawnLocation = value
					end
				end
				speaker.Character:MoveTo(ClosestSpawnLocation.Position)
			end,
		}
	},
}

return plugin
